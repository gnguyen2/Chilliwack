<head>
    <link rel="stylesheet" href = "static/dashboard.css">
</head>

<body>
    <div class="welcome">
        <h1>Welcome, {{ user.name }}</h1>
        <p>Email: {{ user.email }}</p>
        <p>Debug: Role is "{{ user.role }}"</p>
        <p>Debug: Status is "{{ user.status }}"</p>

    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash-message {{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div class="role_check_box">
        <button type="button" class="color_change_button" id="basic_user_button">basic user</button>
        <button type="button" class="color_change_button" id="privlaged_user_button">privlaged user</button>
        <button type="button" class="color_change_button" id="administrator_button">Administrator</button>
    </div>

    <a href="{{ url_for('logout') }}">Logout</a>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Select all buttons
            const buttons = document.querySelectorAll(".color_change_button");
    
            // Get user role from a hidden data attribute or a JavaScript variable
            const userRole = "{{ user.role|replace('\"', '')|replace('<', '')|replace('>', '') }}".trim();
    
            // Define role-based permissions
            const rolePermissions = {
                "basicuser": ["basic_user_button"],
                "privlageduser": ["basic_user_button", "privlaged_user_button"],
                "administrator": ["basic_user_button", "privlaged_user_button", "administrator_button"]
            };

    
            buttons.forEach(button => {
                button.addEventListener("click", function () {
                    // Check if the button is allowed for the user's role
                    if (!rolePermissions[userRole] || !rolePermissions[userRole].includes(this.id)) {
                        alert("You do not have permission to select this role.");
                        return;
                    }
    
                    // If this button is already active, remove the active class
                    if (this.classList.contains("active")) {
                        this.classList.remove("active");
                    } else {
                        // Remove active class from all buttons
                        buttons.forEach(btn => btn.classList.remove("active"));
    
                        // Add active class to the clicked button
                        this.classList.add("active");
                    }
                });
            });
        });
    </script>
    
    
</body>

